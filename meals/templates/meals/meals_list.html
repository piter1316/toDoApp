{% extends 'todo/base.html' %}


{% block body %}
{% load split %}
<div class="container-fluid bg-light py-2 mt-3">
  <div class="row">
    {% include 'meals/menu.html' %}
    <div class="col-12 col-md-10 ">
      <div class="table-responsive-sm">
        <table class="table table-hover table-dark table-striped table-sm">
          <thead class="bg-secondary">
          <tr>
            <th scope="col"></th>
            {% for meal_option in generated_user_meals_options %}
            <th scope="col"><b>{{meal_option.meal_option__meal_option|upper}}</b></th>
            {% endfor %}
          </tr>
          </thead>
          <tbody>
          {% for item in day_meal_option_meal_list %}
          {% for day, meals in item.items %}
          <tr>
            <th scope="row">
              {% with day_as_list=day|split %}
              {{day_as_list.0}}
              {% endwith %}
            </th>
            {% for meal in meals %}
            <td>{%for ch_meal, all in meal.items%}
              {{ch_meal}}
              <button type="button" class="btn  p-0" data-toggle="modal"
                      data-target="#edit_meals_list_pos_{{ch_meal.id}}">
                <i class=" fas fa-edit p-0 "></i>
              </button>
              <!-- Modal -->
              <div class="modal fade" id="edit_meals_list_pos_{{ch_meal.id}}" tabindex="-1" role="dialog"
                   aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
                <form action="{% url 'meals:update_meals_list' %}" method="post"
                      class="modal-dialog modal-dialog-centered" role="document">
                  {% csrf_token %}
                  <div class="modal-content">
                    <div class="modal-header">
                      <h5 class="modal-title" id="exampleModalLongTitle">Modal title</h5>
                      <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                      </button>
                    </div>
                    <div class="modal-body text-dark">
                      <input type="hidden" name="record_id" value="{{ch_meal.id}}">
                      <input type="hidden" name="meal_option_id" value="{{ch_meal.meal_option_id}}">
                      <input type="hidden" name="meal_id" value="{{ch_meal.meal_id}}">
                      ---
                      <select name="to_update">
                        <option value="{{ch_meal.meal_id}}">{{ch_meal}}</option>
                        {% for m in all %}
                          <option value="{{m.id}}">{{m}}{% if m.special %} ** {% endif %}</option>
                        {% endfor %}
                      </select>
                    </div>
                    <div class="modal-footer">
                      <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                      <button type="submit" class="btn btn-primary">Save changes</button>
                    </div>
                  </div>
                </form>
              </div>
              {% endfor %}
            </td>
            {% endfor %}
          </tr>
          {% endfor %}
          {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>
{% endblock %}